<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>購物車</title>
    <link rel="icon" href="img/index/favicon3.ico">
    <link rel="stylesheet" href="basicSetting.css">
    <link rel="stylesheet" href="CARTcart.css">


</head>

<body>
    <!-- topbar 首頁區  -->
    <header id="topbar">
        <!-- 漢堡按鈕 -->
        <!-- <div class="nav_box">
            <button class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </button>
        </div> -->
        <ul class="menu">
            <li><a href="about.html">
                    <h3>關於蘵感</h3>
                </a></li>
            <li><a href="news.html">
                    <h3>最新消息</h3>
                </a></li>
            <li><a href="course.html">
                    <h3>課程介紹</h3>
                </a></li>
            <li><a href="media.html">
                    <h3>蘵感文章</h3>
                </a></li>
        </ul>
        <a href="index.html" class="logo">
            <img src="img/index/index-topbar/logo.svg" alt="logo">
        </a>
        <!-- 選單列 -->
        <nav class="navigation">
            <ul class="icon">
                <li><a href="signup.html" class="icon_signup">
                        <h3>快速報名</h3>
                        <img src="img/index/index-topbar/立即報名（白）.svg" alt="立即報名（白）">
                    </a></li>
                <li><a href="login.html" class="icon_login">
                        <img src="img/index/index-topbar/user.svg" alt="user">
                        <h3>登入</h3>
                    </a>
                </li>
                <li><a href="CARTcart.html"><img src="img/index/index-topbar/cart.svg" alt="cart" width="40" height="40"></a>
                    <div class="num-cart"><h3>0</h3></div>
                </li>
            </ul>
        </nav>
    </header>


    <!-- topbarm 首頁區  -->
    <header id="topbarm">
        <div class="nav_box">
            <!-- 漢堡按鈕 -->
            <button class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </button>
            <!-- 選單列 -->
            <nav class="navigation">
                <ul class="menu">
                    <li>
                        <a href="signup.html" class="icon_signup">
                            <h3>快速報名</h3>
                            <img src="img/index/index-topbar/立即報名（白）.svg" alt="立即報名（白）">
                        </a>
                    </li>
                    <li>
                        <a href="about.html">
                            <h3>關於蘵感</h3>
                        </a>
                    </li>
                    <li>
                        <a href="news.html">
                            <h3>最新消息</h3>
                        </a>
                    </li>
                    <li>
                        <a href="course.html">
                            <h3>課程介紹</h3>
                        </a>
                    </li>
                    <li>
                        <a href="media.html">
                            <h3>蘵感文章</h3>
                        </a>
                    </li>
                    <li>
                        <a href="login.html" class="icon_login">
                            <img src="img/index/index-topbar/user.svg" alt="user">
                            <h3>登入</h3>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
        <h1 class="logo">
            <a href="index.html">
                <img src="img/index/index-topbar/logo.svg" alt="logo">
            </a>
        </h1>
        <!-- 購物車 -->
        <li>
            <a href="cart.html">
                <img src="img/index/index-topbar/cart.svg" alt="cart">
            </a>
        </li>
    </header>

    <!-- cart購物車區 -->
    <div id="cart">
        <!-- 上面導覽列 -->
        <div class="nav">
            <h3>CART</h3>
            <h1>購物車</h1>
        </div>
        <!-- 資料核對區  -->
        <nav>
            <div class="deta">
                <h2>資料核對</h2>
                <p><span class="bold">您好，林洛洛！</span> <br>
                    請確認以下預約的課程是否正確，謝謝配合。</p>
                <h3>我們將寄簡章到您的信箱：
                    <span class="eng">lolitama@gmail.com</span>
                </h3>
            </div>
        </nav>
        <!-- 整個區塊 -->
        <!-- <span class="area"> -->
        <div class="bar">
            <div>
                <h3 class="course_c">Course</h3>
                <h3 class="price">Price</h3>
                <h3 class="no">Quantity</h3>
                <h3 class="no">Subtotal</h3>
            </div>
            <!-- <hr class="hrb"> -->
        </div>
        <!-- 右邊小區塊  -->


    <!-- 茶藝興趣A班 -->
    <div id="cartlist">
        <div class="shop-item">
            <h2>茶藝興趣A班</h2>
            <h3 class="friday">週五下午14:00-16:00，共6堂 <br>
                3/3、3/10、3/17、3/24、3/31、4/7</h3>
          
            <div class="money">
                <h4>$</h4>
                <h1>8000</h1>
            </div>

            <div class="box">
                <div class="minus">-</div>
                <div class="num">1</div>
                <div class="add">+</div>
            </div>
       
            <div class="subtotal">
                <h4>$</h4>
                <h1>8000</h1>
            </div>
            <hr class="mini">
        </div>


        <!-- 活動:金工山林遊: 悠悠 
        <div class="shop-item">
        <div class="tea">
            <div class="small2">
                <img src="img/cart/down.svg" alt="">
            </div>
            <span class="act">
                <h3>活動</h3>
                <h1>4/13</h1>
                <h2>金工山林遊: 悠悠</h2>
            </span>
            <h3><span class="noon"> 下午14:00-16:00，共1堂</span></h3>
           
            <div class="money">
                <h4>$</h4>
                <h1>8000</h1>
            </div>
          
            <div class="box sub9">
                <div class="minus1">-</div>
                <div class="num1">1</div>
                <div class="add1">+</div>
            </div>
         
            <div class="subtotal sub99">
                <h4>$</h4>
                <h1>8000</h1>
            </div>
            <hr class="mini mini9">
        </div>
        <hr class="hrb hrb1">
    </div>-->



        <!-- 購物車總計 -->
        <div class="total">
            <hr>
            <div class="total_money">
                <h2>購物車總計</h2>
                <div class="nt">
                    <h4>NT$</h4>
                    <h1 class="total_price"></h1>
                </div>
            </div>
            <hr>
        </div>
        <!-- 送出預約訂單 -->
        <div class="sent">
            <button>
                <a href="reserve.html">
                    <h3>送出預約訂單</h3>
                </a>
            </button>
        </div>
    </div>
        <!-- 上一個步驟 -->
        <div class="more">
            <a href="signup suc.html">
                <h3>Prev Step</h3>
            </a>
            <img src="img/news/left arrow.svg" alt="">
        </div>
        </div>
    </div>

    <!-- footer -->
    <!-- footer -->
    <div id="footer">
        <div class="blank"></div>
        <div class="footer_ul">
            <!-- 第一欄 -->
            <ul>
                <div class="footer_li">
                    <div class="footer_nav">
                        <li>
                            <h1>
                                <img src="img/index/index-footer/logo all.svg" alt="">
                            </h1>
                        </li>
                    </div>
                    <div class="footer_main">
                        <li class="copyright">
                            &copy;ZanGan.aestheticsCourse
                        </li>
                    </div>
                </div>
            </ul>
            <!-- 第二欄 -->
            <ul>
                <div class="footer_li">
                    <div class="footer_nav">
                        <li>
                            <a href="about.html#contact">
                                <h1 class="eng"> Access</h1>
                                <!-- &nbsp;空白,可以一直增加 -->
                                <p>
                                    <h3>
                                        <div class="addr">
                                            32462 <br>
                                            台北市枕頭村乃貓巷第一個盆栽下 3F
                                        </div>
                                        <div class="time">
                                            <h3>電話號碼&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;02-9900206
                                            </h3>
                                            <h3>營業時間&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10:30-20:00
                                            </h3>
                                            <h3>公休日&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;星期二/三
                                                (國定假期)</h3>
                                        </div>
                                    </h3>
                                </p>
                            </a>
                        </li>
                    </div>
                    <div class="footer_main">
                        <li class="icon_soc">
                            <a href="about.html#contact">
                                <img src="img/index/index-footer/社群軟體icon.svg" alt="">
                            </a>
                        </li>
                    </div>
                </div>
            </ul>
            <!-- 第三欄 -->
            <ul>
                <div class="footer_li">
                    <div class="footer_nav">
                        <li class="contact">
                            <a href="about.html#contact_connect">
                                <h1 class="eng"> Contact</h1>
                            </a>
                            <h3> 有什麼想詢問的嗎?</h3>
                        </li>
                    </div>
                    <div class="footer_main">
                        <li class="faq">
                            <a href="about.html#contact_faq">
                                <h1 class="eng"> FAQ</h1>
                            </a>
                            <h3> 一些常見的問題</h3>
                        </li>
                    </div>
                </div>
            </ul>
        </div>
    </div>
  
    <!-- 自訂的js,一定要放在最下面,最後被執行 -->

      <!-- jQuery Core 3.7.0原始碼,一定要放在最上面,先被執行 -->
      <script src="https://code.jquery.com/jquery-3.7.0.min.js"
      integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
      <script src="script.js"></script>
      <script src="CART.js"></script>
      <script>
        // 從本地儲存中獲取資料
        var jsonData = localStorage.getItem("cartData");

        // 將JSON字符串轉換為對象
        var product_list = JSON.parse(jsonData);

        var cart_list = localStorage.getItem("cart_list");
        var cart_item_number = localStorage.getItem("cart_item_number");

        // 檢查購物車是否為空
        if (cart_list && cart_item_number > 0) {
            // 將JSON字符串轉換為對象
            cart_list = JSON.parse(cart_list);
            $(".num-cart").text(cart_item_number);
        } else {
            // 購物車為空，初始化為空陣列
            cart_list = [];
            cart_item_number = 0;
        }
        function showCart() {
            $("#cartlist").html("");
            var total_price = 0;
            for (var i = 0; i < cart_list.length; i++) {
                var current_cart_item = cart_list[i];
                total_price += parseInt(current_cart_item.price) * current_cart_item.quantity;
                var subtotal = parseInt(current_cart_item.price) * parseInt(current_cart_item.quantity);
                
                var current_cart_list =
                    `<div class="shop-item">
                        <h2>${current_cart_item.name}</h2>
                        <h3 class="friday">${current_cart_item.course_content}</h3>
                        <div class="money">
                            <h4>$</h4>
                            <h1>${current_cart_item.price}</h1>
                        </div>
                        <input class="box" data-list="${i}" data-prod="${current_cart_item.prodid}" type="number" min="1" value="${current_cart_item.quantity}">
                        <div class="subtotal">
                            <h4>$</h4>
                            <h1>${subtotal}</h1>
                        </div>
                        <div data-delid="${i}" data-prodid="${current_cart_item.prodid}" class="mini"></div>
                    </div>`;
                $("#cartlist").append(current_cart_list);
            }
            var current_total = `<div class="total">
                                    <hr>
                                    <div class="total_money">
                                        <h2>購物車總計</h2>
                                        <div class="nt">
                                            <h4>NT$</h4>
                                            <h1 class="total_price">${total_price}</h1>
                                        </div>
                                    </div>
                                    <hr>
                                </div>`;
            $("#cartlist").append(current_total);

            var current_sent = ` <div class="sent">
                                    <button>
                                        <a href="reserve.html">
                                            <h3>送出預約訂單</h3>
                                        </a>
                                    </button>
                                </div>`;
            $("#cartlist").append(current_sent);

            // Call remove function
            $(".mini").click(function () {
                var relate_prod = products[parseInt($(this).attr("data-prodid"))];
                removeItem(parseInt($(this).attr("data-delid")));
                $(".add-cart[data-pdid='" + parseInt($(this).attr("data-prodid")) + "']").css("pointer-events", "auto");
                $(".add-cart[data-pdid='" + parseInt($(this).attr("data-prodid")) + "']").css("background", "black");
            });

            // Call change quantity function
            $(".box").change(function () {
                changeQuantity(parseInt($(this).attr("data-list")), $(this).val());
            });

            // Update total price
            $(".total_price").text(parseInt(total_price));;
        }
        function changeQuantity(listId, newQuantity) {
        cart_list[listId].quantity = parseInt(newQuantity);
        localStorage.setItem("cart_list", JSON.stringify(cart_list));

        // 更新小计
        var currentBox = $(".box[data-list='" + listId + "']");
        var currentSubtotal = currentBox.siblings(".subtotal");
        var price = parseInt(currentBox.siblings(".money").find("h1").text());
        var quantity = parseInt(newQuantity);
        var subtotal = price * quantity;
        currentSubtotal.find("h1").text(subtotal);

        // 更新总计
        var total = 0;
        $(".subtotal").each(function () {
            total += parseInt($(this).find("h1").text());
        });
        $(".total_price").text(total);
    }

    function removeItem(delid) {
        cart_list.splice(delid, 1);

        localStorage.setItem("cart_list", JSON.stringify(cart_list));
        localStorage.setItem("cart_item_number", cart_list.length);
        showCart();
    }

    $(document).ready(function () {
    // 获取本地存储中的购物车数量
    var cart_item_number = localStorage.getItem("cart_item_number");
    // 更新购物车图标上的数量
    $(".num-cart").text(cart_item_number);
        showCart();
    });


    
    </script>
  
</body>

</html>